@{
    ViewBag.Title = @ViewBag.Trip.Name + " - Settings";
    TripSettingsForm form = ViewBag.Form;
    User currentUser = ViewBag.CurrentUser;
    Trip trip = ViewBag.Trip;
}
@Html.Action("SidePanel", "Trips", new { trip })
<div id="main-container">
    <div class="panel">
        <div class="panel-title">
            <h1>
                @ViewBag.Title
            </h1>
        </div>
        @if (!currentUser.CreatedTrips(trip))
        {
            <div class="subtitle warning">
                Only <a href="@Url.Details(trip.Creator)">@trip.Creator.FullName</a> can change the name of this trip.
            </div>
        }
        @if (TempData["saved"] != null)
        {
            <div class="subtitle">
                Trip settings have been saved.
            </div>
        }
        <div class="panel-content">
            <form action="@Url.Settings((Trip)ViewBag.Trip)" method="post" id="trip-settings-form" >
            @Html.AntiForgeryToken()
            <p>
                @Html.ValidationMessage("name")
                <label for="name">
                    Name your trip</label>
                <input type="text" name="name" id="name" value="@ViewBag.Form.Name" tabindex="1" @(currentUser.CreatedTrips(trip) ? "class=\"focus\"" : "disabled=\"disabled\"") />
            </p>
            <p>
                <label for="visibility">
                    Visibility</label>
                @Html.DropDownList("visibility", form.Visibility.ToSelectList())
            </p>
            <input type="submit" value="Save Settings" tabindex="2" />
            </form>
        </div>
    </div>
</div>
